name       : zlib
version    : 1.2.11
release    : 16
source     :
    - http://zlib.net/zlib-1.2.11.tar.gz : c3e5e9fdd5004dcb542feda5ee4f0ff0744628baf8ed2dd5d66f8ca1197cb1a1
homepage   : http://www.zlib.net
license    : ZLIB
component  : system.base
summary    :
    - zlib (Compression library)
    - minizip : Mini zip and unzip based on zlib
description:
    - The zlib library is a compression library that aims to be unobtrusive.
    - minizip : Mini zip and unzip based on zlib
devel      : yes
emul32     : yes
patterns   :
    - minizip :
        - /usr/lib64/libminizip.so.*
    - minizip-devel :
        - /usr/include/minizip/*
        - /usr/lib64/libminizip.so
        - /usr/lib64/pkgconfig/minizip.pc
setup      : |
    %patch -p1 < $pkgfiles/no_ldconfig.patch
    ./configure --prefix=/usr \
                --libdir=%libdir%

    # configure minizip
    pushd contrib/minizip
    if [[ ! -z "${EMUL32BUILD}" ]]; then
        echo "not building 32bit minizip"
    else
        %reconfigure --disable-static
    fi
    popd
build      : |
    %make

    # build minizip
    pushd contrib/minizip
    if [[ ! -z "${EMUL32BUILD}" ]]; then
        echo "not building 32bit minizip"
    else
        %make
    fi
    popd
install    : |
    %make_install

    # install minizip
    pushd contrib/minizip
    if [[ ! -z "${EMUL32BUILD}" ]]; then
        echo "not building 32bit minizip"
    else
        %make_install
    fi
    popd

    rm -vf "$installdir"/%libdir%/*.a

